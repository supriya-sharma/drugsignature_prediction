---
title: "MultiDrug_validation_ICBR"
author: "Supriya Sharma"
date: "June 22, 2016"
output: html_document
---

library(Biobase)
devtools::install_github("wevanjohnson/ASSIGN")
library(ASSIGN)

##### read the VPA gene list

topGenes_unique_vpa <- read.csv("vpa_diffGene_fdr_0.05.csv", header = TRUE)
topcor_vpa <- list(topGenes_unique_vpa[,1])


##### read the SAHA gene list

topGenes_unique_saha <- read.csv("saha_diffGene_fdr_0.05.csv", header = TRUE)
topcor_saha <- list(topGenes_unique_saha[,1])


### read the TSA gene list

topGenes_unique_tsa <- read.csv("tsa_diffGene_fdr_0.05.csv", header = TRUE)
topcor_tsa <- list(topGenes_unique_tsa[,1])


#### combine the list for three drugs

topcor <- list(vpa=as.character(topcor_vpa[[1]]), saha=as.character(topcor_saha[[1]]),tsa=as.character(topcor_tsa[[1]]))


exp_data<- read.table("cellLine.txt",header=T, row.names="external_gene_id")
expr_data <- exp_data[complete.cases(exp_data),]

#### label the training data
training_label <-  list(control=list(saha=1:13,vpa=1:13,tsa=1:13),saha=14:20, vpa=21:28, tsa=29:36)

#####  read TCGA oral cancer data
library(Biobase)
icbp_data <- readRDS("icbp_drug_response_vpatsasaha.rds")
#write.csv(icbp_data,"icbp_dataresponse.csv")

icbp<- readRDS("icbp_Rsubread_tpmlog.rds")

# multi-pathway analysis
assign.wrapper(trainingData=expr_data,
               testData=icbp,
               trainingLabel=training_label,
               testLabel=NULL,
               geneList=topcor,
               n_sigGene=NULL,
               adaptive_B=TRUE,
               adaptive_S=TRUE,
               mixture_beta=FALSE,
               outputDir="/Users/supriyasharma/Desktop/Genome Medicine/icbp/new/newtr_label",
               iter=100000,
               burn_in=50000)

#### single pathway analysis with training data- VPA signatures ONLY

training_vpa<- expr_data[,c(1:13,21:28)]

training_label_vpa <- list(control=list(vpa=14:21),vpa=1:13)

assign.wrapper(trainingData=training_vpa, 
               testData=icbp,
               trainingLabel=training_label_vpa, 
               testLabel=NULL,
               geneList=topcor_vpa,
               n_sigGene=NULL, 
               adaptive_B=TRUE, 
               adaptive_S=TRUE, 
               mixture_beta=FALSE,
               outputDir="/Users/supriyasharma/Desktop/Genome Medicine/icbp/new/vpa",iter=100000,burn_in=50000)


#### single pathway analysis with training data- TSA signatures ONLY
training_tsa<- expr_data[,c(1:13,29:36)]

training_label_tsa <- list(control=list(tsa=14:21),tsa=1:13)
 
assign.wrapper(trainingData=training_tsa,
               testData=icbp,
               trainingLabel=training_label_tsa,
               testLabel=NULL,
               geneList=topcor_tsa,
               n_sigGene=NULL, 
               adaptive_B=TRUE,
               adaptive_S=TRUE,
               mixture_beta=FALSE,
               outputDir="/Users/supriyasharma/Desktop/Genome Medicine/icbp/new/tsa",iter=100000,burn_in=50000)

#### single pathway analysis with training data- SAHA signatures ONLY
training_saha<- expr_data[,c(1:13,14:21)]

training_label_saha <- list(control=list(saha=14:21),saha=1:13)

assign.wrapper(trainingData=training_saha,
               testData=icbp,
               trainingLabel=training_label_saha,
               testLabel=NULL,
               geneList=topcor_saha,
               n_sigGene=NULL,
               adaptive_B=TRUE,
               adaptive_S=TRUE,
               mixture_beta=FALSE, 
               outputDir="/Users/supriyasharma/Desktop/Genome Medicine/icbp/new/saha",iter=100000,burn_in=50000)


This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r}
summary(cars)
```

You can also embed plots, for example:

```{r, echo=FALSE}
plot(cars)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
